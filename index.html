<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Sick Game</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="game-wrapper">
      <div class="game-container" id="game">
        <div class="settings-icon" onclick="toggleSettings()">‚öôÔ∏è</div>
        <div class="settings-menu hidden" id="settingsMenu">
          <label><input type="checkbox" id="soundToggle" checked /> Sound</label
          ><br />
          <label
            ><input type="checkbox" id="vibrationToggle" checked />
            Vibration</label
          >
        </div>

        <h1>Sick Game ü§¢</h1>
        <p>Level: <span id="level">1</span> / 30</p>
        <p>Money Earned: <span id="money" class="money-amount">$0</span></p>
        <p>Which ball hides the coin?</p>

        <div class="game-board">
          <div class="ball yellow" onclick="makeGuess(0)" id="ball-0"></div>
          <div class="ball blue" onclick="makeGuess(1)" id="ball-1"></div>
          <div class="ball green" onclick="makeGuess(2)" id="ball-2"></div>
        </div>

        <div class="result" id="result"></div>
      </div>

      <div class="game-over hidden" id="game-over">
        <p>‚ùå You failed!</p>
        <button onclick="restartGame()">Play Again</button>
      </div>
    </div>

    <audio id="soundSuccess" src="sounds/success.mp3"></audio>
    <audio id="soundFail" src="sounds/fail.mp3"></audio>

    <script>
      let coinPosition = Math.floor(Math.random() * 3);
      let currentLevel = 1;
      const maxLevel = 30;
      let money = 0;
      let inputLocked = false;

      const soundSuccess = document.getElementById("soundSuccess");
      const soundFail = document.getElementById("soundFail");

      document.getElementById("money").textContent = "$" + money;

      function playSound(sound) {
        const soundToggle = document.getElementById("soundToggle").checked;
        if (soundToggle) {
          sound.currentTime = 0;
          sound.play();
        }
      }

      function toggleSettings() {
        document.getElementById("settingsMenu").classList.toggle("hidden");
      }

      function makeGuess(guess) {
        if (inputLocked) return;
        inputLocked = true;

        const result = document.getElementById("result");
        const levelSpan = document.getElementById("level");
        const moneySpan = document.getElementById("money");
        const selectedBall = document.getElementById(`ball-${guess}`);
        const allBalls = document.querySelectorAll(".ball");
        const selectedColor = selectedBall.classList.contains("yellow")
          ? "yellow"
          : selectedBall.classList.contains("blue")
          ? "blue"
          : "green";

        allBalls.forEach((ball) => {
          ball.classList.remove(
            "correct-ball",
            "match-yellow",
            "match-blue",
            "match-green"
          );
          ball.style.transform = "scale(1)";
        });

        if (guess === coinPosition) {
          selectedBall.classList.add("correct-ball");

          if (currentLevel <= 10) {
            money = currentLevel;
          }

          moneySpan.textContent = "$" + money;
          result.innerHTML = `<span style="color:green;font-weight:bold;">‚úÖ You earned $${money}!</span>`;
          playSound(soundSuccess);

          allBalls.forEach((ball, i) => {
            if (i !== guess) {
              ball.classList.add(`match-${selectedColor}`);
            }
          });

          setTimeout(() => {
            if (currentLevel < maxLevel) {
              currentLevel++;
              levelSpan.textContent = currentLevel;
              result.textContent = "Next level starting...";
              coinPosition = Math.floor(Math.random() * 3);
              resetBalls();
              inputLocked = false;
            } else {
              result.textContent = "üèÜ All levels complete!";
            }
          }, 3000);
        } else {
          playSound(soundFail);
          document.getElementById("game").classList.add("wipe-out");
          document.getElementById("game-over").classList.remove("hidden");
          setTimeout(() => {
            document.getElementById("game").classList.add("hidden");
            inputLocked = false;
          }, 2000);
        }
      }

      function resetBalls() {
        document.querySelectorAll(".ball").forEach((ball) => {
          ball.classList.remove(
            "correct-ball",
            "match-yellow",
            "match-blue",
            "match-green"
          );
          ball.style.backgroundColor = "";
          ball.style.border = "2px solid #000";
          ball.style.transform = "scale(1)";
        });
      }

      function restartGame() {
        currentLevel = 1;
        money = 0;
        coinPosition = Math.floor(Math.random() * 3);
        document.getElementById("level").textContent = currentLevel;
        document.getElementById("result").textContent = "";
        document.getElementById("money").textContent = "$" + money;
        document.getElementById("game").classList.remove("wipe-out", "hidden");
        document.getElementById("game-over").classList.add("hidden");
        resetBalls();
        inputLocked = false;
      }
    </script>
  </body>
</html>
